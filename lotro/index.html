<!DOCTYPE html>
<html>
  <head>
    <title>Skynet's Amazing Raid Sorting Hat</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="icons.css" />
    <link rel="stylesheet" type="text/css" href="style.css" />
    <link rel="stylesheet" type="text/css" href="prettify.css" />
    <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script>
        $('.weNeedMoreDPS').click(function() {
            $('#sorting').toggleClass('close');
        });
    </script> -->
  </head>
  <body>
    <h3>Skynet's Amazing Raid Sorting Hat</h3>
    <div>#BeleRules</div><br/>

    <button id="sort" onclick="sTable()">Toggle Lineup View</button>
    <!-- <button id="sort" onclick="sort()">Sorting Hat</button> -->
    <!-- <button class="weNeedMoreDPS">Toggle Lineup View</button> -->
    <div id="wrapper">
    <pre id="content" style="white-space: pre-wrap;"></pre>
    <div id="sorting" style="display:none">
        <table id="slot1c">
            <th>Friday 8AM &nbsp;<div onclick="copy(1)" class="copy tip tipright"><span>Copy Lineup</span></div></th>
            <tr><td>Main Tank</td><td class='pMain'></td></tr>
            <tr><td>Off Tank</td><td class='pOff'></td></tr>
            <tr><td>Heal 1</td><td class='pH1'></td></tr>
            <tr><td>Heal 2</td><td class='pH2'></td></tr>
            <tr><td>LM</td><td class='pLM'></td></tr>
            <tr><td>Burg</td><td class='pBurg'></td></tr>
            <tr><td>Red Cpt</td><td class='pRcpt'></td></tr>
            <tr><td>DPS 1</td><td class='pDPS1'></td></tr>
            <tr><td>DPS 2</td><td class='pDPS2'></td></tr>
            <tr><td>DPS 3</td><td class='pDPS3'></td></tr>
            <tr><td>DPS 4</td><td class='pDPS4'></td></tr>
            <tr><td>DPS 5</td><td class='pDPS5'></td></tr>
            <tr><td>Alternates</td><td id="a1"></td></tr>
        </table>
        <table id="slot2c">
            <th>Friday 8PM &nbsp;<div onclick="copy(2)" class="copy tip tipright"><span>Copy Lineup</span></div></th>
            <tr><td>Main Tank</td><td class='pMain'></td></tr>
            <tr><td>Off Tank</td><td class='pOff'></td></tr>
            <tr><td>Heal 1</td><td class='pH1'></td></tr>
            <tr><td>Heal 2</td><td class='pH2'></td></tr>
            <tr><td>LM</td><td class='pLM'></td></tr>
            <tr><td>Burg</td><td class='pBurg'></td></tr>
            <tr><td>Red Cpt</td><td class='pRcpt'></td></tr>
            <tr><td>DPS 1</td><td class='pDPS1'></td></tr>
            <tr><td>DPS 2</td><td class='pDPS2'></td></tr>
            <tr><td>DPS 3</td><td class='pDPS3'></td></tr>
            <tr><td>DPS 4</td><td class='pDPS4'></td></tr>
            <tr><td>DPS 5</td><td class='pDPS5'></td></tr>
            <tr><td>Alternates</td><td id="a2"></td></tr>
        </table>
        <table id="slot3c">
            <th>Saturday 8AM &nbsp;<div onclick="copy(3)" class="copy tip tipright"><span>Copy Lineup</span></div></th>
            <tr><td>Main Tank</td><td class='pMain'></td></tr>
            <tr><td>Off Tank</td><td class='pOff'></td></tr>
            <tr><td>Heal 1</td><td class='pH1'></td></tr>
            <tr><td>Heal 2</td><td class='pH2'></td></tr>
            <tr><td>LM</td><td class='pLM'></td></tr>
            <tr><td>Burg</td><td class='pBurg'></td></tr>
            <tr><td>Red Cpt</td><td class='pRcpt'></td></tr>
            <tr><td>DPS 1</td><td class='pDPS1'></td></tr>
            <tr><td>DPS 2</td><td class='pDPS2'></td></tr>
            <tr><td>DPS 3</td><td class='pDPS3'></td></tr>
            <tr><td>DPS 4</td><td class='pDPS4'></td></tr>
            <tr><td>DPS 5</td><td class='pDPS5'></td></tr>
            <tr><td>Alternates</td><td id="a3"></td></tr>
        </table>
        <table id="slot4c">
            <th>Saturday 8PM &nbsp;<div onclick="copy(4)" class="copy tip tipright"><span>Copy Lineup</span></div></th>
            <tr><td>Main Tank</td><td class='pMain'></td></tr>
            <tr><td>Off Tank</td><td class='pOff'></td></tr>
            <tr><td>Heal 1</td><td class='pH1'></td></tr>
            <tr><td>Heal 2</td><td class='pH2'></td></tr>
            <tr><td>LM</td><td class='pLM'></td></tr>
            <tr><td>Burg</td><td class='pBurg'></td></tr>
            <tr><td>Red Cpt</td><td class='pRcpt'></td></tr>
            <tr><td>DPS 1</td><td class='pDPS1'></td></tr>
            <tr><td>DPS 2</td><td class='pDPS2'></td></tr>
            <tr><td>DPS 3</td><td class='pDPS3'></td></tr>
            <tr><td>DPS 4</td><td class='pDPS4'></td></tr>
            <tr><td>DPS 5</td><td class='pDPS5'></td></tr>
            <tr><td>Alternates</td><td id="a4"></td></tr>
        </table>
        <table id="slot5c">
            <th>Sunday 8AM &nbsp;<div onclick="copy(5)" class="copy tip tipright"><span>Copy Lineup</span></div></th>
            <tr><td>Main Tank</td><td class='pMain'></td></tr>
            <tr><td>Off Tank</td><td class='pOff'></td></tr>
            <tr><td>Heal 1</td><td class='pH1'></td></tr>
            <tr><td>Heal 2</td><td class='pH2'></td></tr>
            <tr><td>LM</td><td class='pLM'></td></tr>
            <tr><td>Burg</td><td class='pBurg'></td></tr>
            <tr><td>Red Cpt</td><td class='pRcpt'></td></tr>
            <tr><td>DPS 1</td><td class='pDPS1'></td></tr>
            <tr><td>DPS 2</td><td class='pDPS2'></td></tr>
            <tr><td>DPS 3</td><td class='pDPS3'></td></tr>
            <tr><td>DPS 4</td><td class='pDPS4'></td></tr>
            <tr><td>DPS 5</td><td class='pDPS5'></td></tr>
            <tr><td>Alternates</td><td id="a5"></td></tr>
        </table><br/><br/>
        <label for="weNeedMoreeDPS">Copied Lineup:</label><br/>
        <textarea rows="15" cols="50" name="weNeedMoreeDPS" id="weNeedMoreeDPS">Give it to us raw and wriggling. You keep nasty chips.</textarea>
    </div>
    <div id="container"></div>
    </div>

    <script type="text/javascript">
    function sTable() {
        if(document.getElementById("sorting").style.display=="none") {
            document.getElementById("sorting").style.display = "block";
        }
        else {
            document.getElementById("sorting").style.display = "none";
        }
    }
      // Client ID and API key from the Developer Console
      var CLIENT_ID = '1042370824090-qdt1gct9ftvj4plr2c7lfvmmu1oaq3fp.apps.googleusercontent.com';
      var API_KEY = 'AIzaSyDY8kJ3xKXzza30uBFkJG4FIuJqTbpqLng';

      // Array of API discovery doc URLs for APIs used by the quickstart
      var DISCOVERY_DOCS = ["https://sheets.googleapis.com/$discovery/rest?version=v4"];

      // Authorization scopes required by the API; multiple scopes can be
      // included, separated by spaces.
      var SCOPES = "https://www.googleapis.com/auth/spreadsheets.readonly";

      /**
       *  On load, called to load the auth2 library and API client library.
       */
      function handleClientLoad() {
        gapi.load('client:auth2', initClient);
      }

      /**
       *  Initializes the API client library and sets up sign-in state
       *  listeners.
       */
      function initClient() {
        gapi.client.init({
          apiKey: API_KEY,
          clientId: CLIENT_ID,
          discoveryDocs: DISCOVERY_DOCS,
          scope: SCOPES
        }).then(function () { // we dont need no sign ins!
          skynetMagic();
        }, function(error) {
          appendPre(JSON.stringify(error, null, 2));
        });
      }

      /**
       * Append a pre element to the body containing the given message
       * as its text node. Used to display the results of the API call.
       *
       * @param {string} message Text to be placed in pre element.
       */
      function appendPre(message) {
        var pre = document.getElementById('content');
        var textContent = document.createTextNode(message + '\n');
        pre.appendChild(textContent);
      }

      function appendHtml(message) {
        var div = document.getElementById('container');
        div.innerHTML += message;
      }

    function skynetMagic() {
        gapi.client.sheets.spreadsheets.values.get({
          spreadsheetId: '1AILw6loWKRDATyoPbAulLC4fm1HeuA4eelQ5rCfsNXw',
          range: 'A2:E'
        }).then(function(response) {
          var range = response.result;
          if (range.values.length > 0) {
            output = '<table id="victimsList"><tr>'+
            '<th>No.</th><th>Timestamp</th><th>Name</th><th>Timeslots</th><th>Roles</th><th>Classes</th><th>Info</th>'+
            '</tr>';
            for (i = 0; i < range.values.length; i++) {
              var row = range.values[i];
              var col = (i%2) ? 'odd' : 'even';
              output += '<tr class="tr0 '+col+'"><td>'+(i+1)+'</td><td>'+row[0]+
              outputRow(row,i)+
              '</td></tr>';
            }
            output += '</table>';
            appendHtml(output);
            sort();
          } else {
            appendPre('No data found.');
          }
        }, function(response) {
          appendPre('Error: ' + response.result.error.message);
        });
      }

    function outputRow(data,id) { // processing data
        output = "";
        misc = "";
        // name 
        output += '</td><td>'+data[1];
        // timeslots
        array = data[2].split(", ");
        output += "</td><td> ";
        var cases;
        cases = Array.from({length:5}).map(x => "hide")
        for(var i=0; i<array.length; i++) {
            switch(array[i]) {
                case "Friday 8:00 AM":
                    cases[0] = "show";
                    break;
                case "Friday 8:00 PM":
                    cases[1] = "show";
                    break;
                case "Saturday 8:00 AM":
                    cases[2] = "show";
                    break;
                case "Saturday 8:00 PM":
                    cases[3] = "show";
                    break;
                case "Sunday 8:00 AM":
                    cases[4] = "show";  
                    break;
                default: 
                    misc += "[Timeslot: "+array[i]+"]";
            }
        }
        // I know, not the most effective...but wateva, it works
        output += "<div class=\"fri8am tip "+cases[0]+"\" onclick=\"add(1,id)\"><span>Friday 8AM</span></div>";
        output += "<div class=\"fri8pm tip "+cases[1]+"\" onclick=\"add(2,id)\"><span>Friday 8PM</span></div>";
        output += "<div class=\"sat8am tip "+cases[2]+"\" onclick=\"add(3,id)\"><span>Saturday 8AM</span></div>";
        output += "<div class=\"sat8pm tip "+cases[3]+"\" onclick=\"add(4,id)\"><span>Saturday 8PM</span></div>";
        output += "<div class=\"sun8am tip "+cases[4]+"\" onclick=\"add(5,id)\"><span>Sunday 8AM</span></div>";
        // roles
        array = data[3].split(", ");
        output += "</td><td> ";
        cases = Array.from({length:4}).map(x => "hide")
        for(var i=0; i<array.length; i++) {
            switch(array[i]) {
                case "DPS":
                    cases[0] = "show";
                    break;
                case "Support":
                    cases[1] = "show";
                    break;
                case "Heals":
                    cases[2] = "show";
                    break;
                case "Tank":
                    cases[3] = "show";
                    break;
                default: 
                    misc += "[Role: "+array[i]+"]";
            }            
        }
        output += "<div class=\"dps tip "+cases[0]+"\"><span>DPS</span></div>";
        output += "<div class=\"support tip "+cases[1]+"\"><span>Support</span></div>";
        output += "<div class=\"heals tip "+cases[2]+"\"><span>Heals</span></div>";  
        output += "<div class=\"tank tip "+cases[3]+"\"><span>Tank</span></div>";
        // classes
        array = data[4].split(", ");
        output += "</td><td> ";
        for(var i=0; i<array.length; i++) {
            switch(array[i]) {
                case "Beorning":
                    output += "<div class=\"beorning tip show\"><span>Beorning</span></div> ";
                    break;
                case "Burglar":
                    output += "<div class=\"burg tip show\"><span>Burglar</span></div> ";
                    break;
                case "Captain":
                    output += "<div class=\"cpt tip show\"><span>Captain</span></div> ";
                    break;
                case "Champion":
                    output += "<div class=\"champ tip show\"><span>Champion</span></div> ";
                    break;
                case "Guardian":
                    output += "<div class=\"guard tip show\"><span>Guardian</span></div> ";
                    break;
                case "Hunter":
                    output += "<div class=\"hunt tip show\"><span>Hunter</span></div> ";
                    break;
                case "Lore Master":
                    output += "<div class=\"lm tip show\"><span>Lore Master</span></div> ";
                    break;
                case "Minstrel":
                    output += "<div class=\"mini tip show\"><span>Minstrel</span></div> ";
                    break;
                case "Rune Keeper":
                    output += "<div class=\"rk tip show\"><span>Rune Keeper</span></div> ";
                    break;
                case "Warden":
                    output += "<div class=\"warden tip\"><span>Warden</span></div> ";
                    break;
                default: 
                    misc += "[Class: "+array[i]+"]";
            }
        }
        output += "</td><td>";
        // misc
        if(misc!="") {
            output += "<div class=\"notice tip tipleft\"><span>"+misc+"</span></div>"
        }
        
        return output;
    }
        
    function sort() {
        // create vars
        const slot1=new Array(12),slot2=new Array(12),slot3=new Array(12),slot4=new Array(12),slot5=new Array(12);
        const nameA = [];
        const slotsA = [];
        const rolesA = [];
        const classesA = [];
        // add them all to array
        for(var i=0; i<document.getElementsByClassName("tr0").length; i++) {
            // set vars
            var parent = document.getElementsByClassName("tr0")[i];
            var name = parent.getElementsByTagName("td")[2].innerHTML.split(/\/| /)[0];
            const slots = [];
            const roles = [];
            const classes = [];
            for(var e=3; e<6; e++) {
                for(var j=0; j<parent.getElementsByTagName("td")[e].getElementsByClassName("show").length; j++) {
                    if(e==3) {
                        slots.push(parent.getElementsByTagName("td")[e].getElementsByClassName("show")[j].getElementsByTagName("span")[0].innerHTML);
                    }
                    else if(e==4) {
                        roles.push(parent.getElementsByTagName("td")[e].getElementsByClassName("show")[j].getElementsByTagName("span")[0].innerHTML);
                    }
                    else {
                        classes.push(parent.getElementsByTagName("td")[e].getElementsByClassName("show")[j].getElementsByTagName("span")[0].innerHTML);
                    }
                }
            }
            // add values
            if(nameA.indexOf(name)===-1) {
                nameA.push(name);
                slotsA.push(slots);
                rolesA.push(roles);
                classesA.push(classes);
            }
        }
        const ddMainT = [];
        const ddOffT = [];
        const ddHeals = [];
        const ddLM = [];
        const ddBurg = [];
        const ddCpt = [];
        const ddDPS = [];
        // create the dropdowns
        for(var d=0; d<5; d++) {
            ddMainT[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>';
            ddOffT[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>';
            ddHeals[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>';
            ddLM[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>';
            ddBurg[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>';
            ddCpt[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>';
            ddDPS[d] = '<select class="victims" onchange="update('+d+')"><option value="-1">-- Gollum --</option>'; 
            switch(d) {
                case 0:
                    var o="Friday 8AM"; 
                    break;
                case 1:
                    var o="Friday 8PM"; 
                    break;
                case 2:
                    var o="Saturday 8AM"; 
                    break;
                case 3:
                    var o="Saturday 8PM"; 
                    break;
                case 4:
                    var o="Sunday 8AM"; 
                    break;
            }

            for(var i=0; i<nameA.length; i++) {
                if(!(slotsA[i].indexOf(o)===-1)) {
                    if(!(rolesA[i].indexOf("Tank")===-1)) {
                        // I don't seriously think we're going to see maintank anything but guard and offtank anything but cappy for now, so let's just leave this be for the time being. 
                        if(!(classesA[i].indexOf("Guardian")===-1)) {
                            ddMainT[d] += '<option>'+nameA[i]+'</option>';
                        }
                        if(!(classesA[i].indexOf("Captain")===-1)) {
                            ddOffT[d] += '<option>'+nameA[i]+'</option>';
                        }
                    }
                    if(!(rolesA[i].indexOf("Heals")===-1)) {
                        ddHeals[d] += '<option>'+nameA[i]+'</option>';
                    }
                    if(!(rolesA[i].indexOf("Support")===-1)) {
                        if(!(classesA[i].indexOf("Lore Master")===-1)) {
                            ddLM[d] += '<option>'+nameA[i]+'</option>';
                        }
                        if(!(classesA[i].indexOf("Burglar")===-1)) {
                            ddBurg[d] += '<option>'+nameA[i]+'</option>';
                        }
                        if(!(classesA[i].indexOf("Captain")===-1)) {
                            ddCpt[d] += '<option>'+nameA[i]+'</option>';
                        }
                    }
                    if(!(rolesA[i].indexOf("DPS")===-1)) {
                        ddDPS[d] += '<option>'+nameA[i]+'</option>';
                    }
                }
            }

            ddMainT[d]+='</select>';
            ddOffT[d]+='</select>';
            ddHeals[d]+='</select>';
            ddLM[d]+='</select>';
            ddBurg[d]+='</select>';
            ddCpt[d]+='</select>';
            ddDPS[d]+='</select>';
        }
        
        for(var i=0; i<5; i++) {
            // mt, offtank
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[1].getElementsByTagName("td")[1].innerHTML = ddMainT[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[2].getElementsByTagName("td")[1].innerHTML = ddOffT[i];
            // heals
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[3].getElementsByTagName("td")[1].innerHTML = ddHeals[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[4].getElementsByTagName("td")[1].innerHTML = ddHeals[i];
            //lm, burg, rcpy
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[5].getElementsByTagName("td")[1].innerHTML = ddLM[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[6].getElementsByTagName("td")[1].innerHTML = ddBurg[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[7].getElementsByTagName("td")[1].innerHTML = ddCpt[i];
            // 5 dps
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[8].getElementsByTagName("td")[1].innerHTML = ddDPS[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[9].getElementsByTagName("td")[1].innerHTML = ddDPS[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[10].getElementsByTagName("td")[1].innerHTML = ddDPS[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[11].getElementsByTagName("td")[1].innerHTML = ddDPS[i];
            document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[12].getElementsByTagName("td")[1].innerHTML = ddDPS[i];
        }

        // until i can get my head around 60 for-loops...
        // for(var i=0; i<5; i++) {
        //     for(var j=1; j<13; j++) {
        //         document.getElementById("sorting").getElementsByTagName("table")[i].getElementsByTagName("tr")[j].getElementsByTagName("td")[1].innerHTML = dd;
        //     }
        // }
        // // sort on day first
        // for(var i=0; i<slotsA.length; i++) {
        //     if(slotsA[i].length==1) {
        //         victim = victimise(nameA[i],rolesA[i],classesA[i]);
        //         switch(slotsA[i][0]) {
        //             case "Friday 8AM":
        //                 slot1.push(victim);
        //                 break;
        //             case "Friday 8PM":;
        //                 slot2.push(victim);
        //                 break;
        //             case "Saturday 8AM":;
        //                 slot3.push(victim);
        //                 break; 
        //             case "Saturday 8PM":;
        //                 slot4.push(victim);
        //                 break;
        //             case "Sunday 8AM":;
        //                 slot5.push(victim);
        //                 break;
        //         }
        //     }
        // }
        // for(var i=0; i<12; i++) {
        //     document.getElementById("slot1c").getElementsByTagName("tr")[i].getElementsByTagName("td")[1] = slot1[i].name;
        //     document.getElementById("slot2c").getElementsByTagName("tr")[1].getElementsByTagName("td")[1] = slot2[i].name;
        //     document.getElementById("slot3c").getElementsByTagName("tr")[1].getElementsByTagName("td")[1] = slot3[i].name;
        //     document.getElementById("slot4c").getElementsByTagName("tr")[1].getElementsByTagName("td")[1] = slot4[i].name;
        //     document.getElementById("slot5c").getElementsByTagName("tr")[1].getElementsByTagName("td")[1] = slot5[i].name;
        // }
    }
    function update(slot) {
        if(document.getElementsByClassName("tipright")[slot].classList.contains("copy_done")) {
            document.getElementsByClassName("tipright")[slot].className = "copy tip tipright";
        }
        const list = [];
        const current = [];
        for(var i=0; i<document.getElementsByClassName("tr0").length; i++) {
            // set vars
            var name = document.getElementsByClassName("tr0")[i].getElementsByTagName("td")[2].innerHTML.split(/\/| /)[0];
            switch(slot) {
                case 0: 
                    var c="fri8am"; break;
                case 1: 
                    var c="fri8pm"; break;
                case 2: 
                    var c="sat8am"; break;
                case 3:
                    var c="sat8pm"; break;
                case 4: 
                    var c="sun8am"; break;
            }
            if(document.getElementsByClassName("tr0")[i].getElementsByTagName("td")[3].getElementsByClassName(c+" show").length > 0) { 
                // add values
                if(list.indexOf(name)===-1) {
                    list.push(name);
                }
            }
        }
        // get list of ppl currently in dropdowns
        for(var j=1; j<13; j++) {
            var parent = document.getElementById("sorting").
            getElementsByTagName("table")[slot].
            getElementsByTagName("tr")[j].
            getElementsByTagName("td")[1].
            getElementsByTagName("select")[0];
            // check if person was selected twice
            if(current.indexOf(parent.options[parent.selectedIndex].value)!==-1 && parent.value!=="-1") {
                parent.style.border = "1px solid red";
            }
            else {
                parent.style.border = "";
            }
            current.push(parent.options[parent.selectedIndex].value);
        }
        var out = "";
        var count = 0;
        for(var e=0; e<list.length; e++) {
            if(current.indexOf(list[e])===-1) {
                count++;
                out += (out=="" ? "" : ", " )+list[e];
            }
        }
        document.getElementById("sorting").getElementsByTagName("table")[slot].getElementsByTagName("tr")[13].getElementsByTagName("td")[1].innerHTML = "("+count+") "+out;
    }
    function copy(a) {
        // send em to the textarea
        var out = "";
        var flag = 0;
        out += "** "+document.getElementById("sorting").
        getElementsByTagName("table")[a-1].
        getElementsByTagName("tr")[0].
        getElementsByTagName("th")[0].innerHTML.split("&nbsp;")[0]+"**&#10;";
        for(var j=1; j<14; j++) {
            if(j<13) {
                var parent = document.getElementById("sorting").
                getElementsByTagName("table")[a-1].
                getElementsByTagName("tr")[j].
                getElementsByTagName("td")[1].
                getElementsByTagName("select")[0];
                var name = parent.options[parent.selectedIndex].value=="-1" ? "" : parent.options[parent.selectedIndex].value;
            }
            else {
                var alts = document.getElementById("sorting").
                getElementsByTagName("table")[a-1].
                getElementsByTagName("tr")[j].
                getElementsByTagName("td")[1].innerHTML;
            }
            if(j==1) {
                out += "Main Tank: "+name+"&#10;";
                continue;
            }
            if(j==2) {
                out += "Off Tank: "+name+"&#10;";
                continue;
            }
            if(j==3 || j==4) {
                out += "Heal "+(j-2)+": "+name+"&#10;";
                continue;
            }
            if(j==5) {
                out += "LM: "+name+"&#10;";
                continue;
            }
            if(j==6) {
                out += "Burg: "+name+"&#10;";
                continue;
            }
            if(j==7) {
                out += "Red Cappy: "+name+"&#10;";
                continue;
            }
            if(j==8) {
                out += "DPS: "+name;
                if(name!=="") {
                    flag = 1;
                }
                continue;
            }
            if(j>8 && j<13) {
                out += (flag==0||name=="" ? "" : ", ")+name;
                if(name!=="") {
                    flag = 1;
                }
                continue;
            }
            if(j==13) {
                out += "&#10;&#10;Alternates: "+alts;
            }
        }
        var copyKitty = document.getElementById("weNeedMoreeDPS");
        copyKitty.innerHTML = out;
        // copy
        copyKitty.select();
        copyKitty.setSelectionRange(0, 99999);
        document.execCommand("copy");
        if(document.getElementsByClassName("tipright")[a-1].classList.contains("copy")) {
            document.getElementsByClassName("tipright")[a-1].className = "copy_done tip tipright";
        }
    }

    function add(slot) { 
        // victim = victimise(nameA[id],rolesA[id],classesA[id]);
        // switch(slot) {
        //     case 1:
        //         slot1.push(victim); 
        //         alert(nameA[id]+"added to slot 1!");
        //         break;
        //     case 2: 
        //         slot1.push(victim);
        //         break;
        //     case 3: 
        //         slot1.push(victim);
        //         break;
        //     case 4: 
        //         slot1.push(victim);
        //         break;
        //     case 5: 
        //         slot1.push(victim);
        //         break;
        //     default: 
        //         console.log("error invalid slot!");
        // }
        
    }

    function victimise(name,roles,classes) {
        this.name = name;
        this.roles = roles;
        this.classes = classes;
    }
    </script>

    <script async defer src="https://apis.google.com/js/api.js"
      onload="this.onload=function(){};handleClientLoad()"
      onreadystatechange="if (this.readyState === 'complete') this.onload()">
    </script>
  </body>
</html>